{
	"Shader": {
		"ver": "0.1",
		"info": {
			"id": "MdsGzr",
			"date": "1362142644",
			"viewed": 1028,
			"name": "Mostly Harmless",
			"username": "P_Malin",
			"description": "More 8bit era fun. A Cobra Mk III from Elite with chunky rasterization.<br/>(used with permission by Frontier Developments)<br/>Click in window to override rotation.<br/>",
			"likes": 23,
			"published": 3,
			"flags": 8,
			"tags": [
				"3d",
				"rasterizer",
				"retro",
				"wireframe",
				"line"
			],
			"hasliked": 0
		},
		"renderpass": [
			{
				"inputs": [],
				"outputs": [],
				"code": "",
				"name": "",
				"description": "",
				"type": "image"
			},
			{
				"inputs": [],
				"outputs": [],
				"code": "#define N(T,N) t+=float(T); if(x>t) r=vec2(N,t);\n#define L(T,N,X) t+=float(T); if((x>t) && (x<(t+float(X)))) r=vec2(N,t);\n\nvec2 GetTrack0ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(288,62) N(96,66) N(96,69) N(96,50) N(96,62) N(96,62) N(96,50) N(96,66) N(96,62) N(96,50) N(96,62)\n    N(96,54) N(96,50) N(96,62) N(96,66) N(96,52) N(96,61) N(96,67) N(96,52) N(96,61) N(96,61) N(96,52)\n    N(96,61) N(96,57) N(96,52) N(96,61) N(96,61) N(96,45) N(96,61) N(96,67) N(96,45) N(96,61) N(96,61)\n    N(96,45) N(96,61) N(96,55) N(96,45) N(96,61) N(96,61) N(96,50) N(96,66) N(96,66) N(96,50) N(96,66)\n    N(96,66) N(96,50) N(96,62) N(96,57) N(96,50) N(96,62) N(96,66) N(96,54) N(96,66) N(96,66) N(96,54)\n    N(96,66) N(96,66) N(96,42) N(96,50) N(96,50) N(96,42) N(96,45) N(96,45) N(96,43) N(96,50) N(96,52)\n    N(96,43) N(96,47) N(96,52) N(96,52) N(192,52) N(96,52) N(96,55) N(96,59) N(96,52) N(96,61) N(96,67)\n    N(96,45) N(96,61) N(96,61) N(96,50) N(96,66) N(96,66) N(96,54) N(96,66) N(96,66) N(96,52) N(192,76)\n    N(96,55) N(192,81) N(96,54) N(144,66) N(48,66) N(96,54) N(96,78) N(96,85) N(96,52) N(96,56) N(96,56)\n    N(96,52) N(96,56) N(96,61) N(96,52) N(96,56) N(96,56) N(96,52) N(96,56) N(96,56) N(91,52) N(101,61)\n    N(96,61) N(93,54) N(99,61) N(96,61) N(91,55) N(101,57) N(96,61) N(93,54) N(99,64) N(96,61) L(89,52,7)\n    N(103,56) N(96,56) N(96,52) N(96,56) N(96,61) N(96,52) N(96,56) N(96,62) N(96,52) N(96,59) N(96,62)\n    N(96,61) N(192,57) N(96,54) N(144,78) N(48,74) N(48,71) N(48,52) N(48,78) N(48,56) N(96,52) N(96,57)\n    N(281,81)\n    return r;\n}\n\nvec2 GetTrack0BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(576,69) N(96,66) N(96,66) N(96,81) N(96,62) N(96,66) N(96,78) N(96,54) N(96,57) N(96,62) N(96,57)\n    N(96,62) N(96,67) N(96,67) N(96,61) N(96,81) N(96,67) N(96,67) N(96,79) N(96,57) N(96,55) N(96,61)\n    N(96,57) N(96,57) N(96,71) N(96,67) N(96,61) N(96,79) N(96,67) N(96,67) N(96,73) N(96,57) N(96,57)\n    N(96,61) N(96,57) N(96,57) N(96,71) N(96,62) N(96,57) N(96,78) N(96,62) N(96,57) N(96,78) N(96,57)\n    N(96,54) N(96,62) N(96,57) N(96,62) N(96,74) N(96,62) N(96,62) N(96,86) N(96,62) N(96,62) N(96,81)\n    N(96,45) N(96,45) N(96,62) N(96,54) N(96,54) N(96,74) N(96,52) N(96,47) N(96,86) N(96,50) N(96,50)\n    N(96,50) N(192,64) N(96,64) N(96,67) N(96,71) N(96,71) N(96,67) N(96,61) N(192,67) N(96,67) N(96,78)\n    N(96,57) N(96,62) N(192,57) N(96,62) N(96,47) N(288,45) N(288,50) N(144,69) N(48,69) N(96,50) N(96,86)\n    N(192,85) N(96,62) N(96,62) N(192,62) N(96,64) N(96,82) N(96,62) N(96,62) N(192,62) N(96,62) N(96,45)\n    N(96,57) N(96,64) N(96,45) N(96,57) N(96,57) N(96,45) N(96,61) N(96,64) N(96,45) N(96,57) N(96,64)\n    N(96,52) N(96,62) N(96,64) N(192,62) N(96,64) N(96,76) N(96,64) N(96,56) N(192,64) N(96,59) N(96,54)\n    N(192,81) N(96,59) N(288,40) N(48,71) N(48,44) N(96,40) N(96,45) N(288,67)\n    return r;\n}\n\nvec2 GetTrack0CNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(672,57) N(96,57) N(96,78) N(96,57) N(96,57) N(96,74) N(96,57) N(96,62) N(192,66) N(96,57) N(96,69)\n    N(96,57) N(96,57) N(96,79) N(96,57) N(96,79) N(96,73) N(96,55) N(96,61) N(192,55) N(96,55) N(288,57)\n    N(96,83) N(192,57) N(96,79) N(96,55) N(96,61) N(192,55) N(96,55) N(192,57) N(96,62) N(96,74) N(96,57)\n    N(96,62) N(96,74) N(96,54) N(96,62) N(192,66) N(96,57) N(192,57) N(96,57) N(96,81) N(96,57) N(96,57)\n    N(96,78) N(96,54) N(96,54) N(192,50) N(96,50) N(192,47) N(96,50) N(96,83) N(96,52) N(96,47) N(96,47)\n    N(192,76) N(96,76) N(96,79) N(96,83) N(96,83) N(96,57) N(96,57) N(192,57) N(96,57) N(96,90) N(96,62)\n    N(96,57) N(192,62) N(96,57) N(96,50) N(288,52) N(288,74) N(144,74) N(48,74) N(96,66) N(288,76) N(96,64)\n    N(96,64) N(192,64) N(96,55) N(96,73) N(96,64) N(96,64) N(192,64) N(96,64) N(96,78) N(96,64) N(96,57)\n    N(192,64) N(96,64) N(96,83) N(96,64) N(96,57) N(192,61) N(96,57) N(96,85) N(96,64) N(96,62) N(192,64)\n    N(96,55) N(96,85) N(96,62) N(96,64) N(192,62) N(96,83) N(96,59) N(288,50) N(288,78) N(48,74) N(48,78)\n    N(96,76) N(96,69) N(288,64)\n    return r;\n}\n\nvec2 GetTrack0DNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(768,81) N(288,78) N(576,69) N(288,79) N(288,73) N(480,64) N(96,71) N(288,79) N(288,73) N(480,64)\n    N(96,71) N(288,83) N(96,83) N(192,78) N(576,69) N(288,86) N(288,78) N(288,62) N(192,66) N(96,69) N(288,83)\n    N(288,83) N(96,43) N(960,68) N(96,69) N(480,74) N(96,78) N(96,43) N(288,73) N(576,69) N(384,83) N(96,83)\n    N(192,83) N(96,82) N(192,83) N(96,83) N(192,76) N(96,76) N(288,76) N(192,76) N(96,76) N(96,71) N(192,81)\n    N(192,78) N(96,85) N(96,76) N(96,83) N(96,83) N(192,83) N(96,82) N(96,88) N(96,86) N(96,86) N(192,80)\n    N(192,83) N(288,80) N(288,71) N(48,68) N(48,74) N(96,74) N(96,61)\n    return r;\n}\n\nvec2 GetTrack0ENote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(768,78) N(288,74) N(864,81) N(1152,83) N(288,79) N(864,78) N(288,74) N(864,81) N(288,81) N(864,86)\n    N(288,76) N(96,83) N(960,80) N(96,81) N(480,86) N(192,71) N(288,83) N(576,74) N(384,74) N(96,74) N(192,74)\n    N(96,73) N(192,74) N(96,74) N(1152,69) N(192,86) N(96,76) N(192,74) N(96,74) N(192,74) N(96,85) N(192,83)\n    N(96,83) N(384,71) N(288,68) N(288,74) N(96,71) N(96,71) N(96,64)\n    return r;\n}\n\nvec2 GetTrack0FNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(4224,74) N(2688,76) N(1728,78) N(4128,74) N(96,74) N(960,68) N(96,68) N(96,68)\n    return r;\n}\n\n// ------------------- 8< ------------------- 8< ------------------- 8< -------------------\n\nfloat NoteToHz(float n)\n{  \t\n\treturn 440.0*pow( 2.0, (n-69.0)/12.0 );\n}\n\nfloat Sin(float x)\n{\n    return sin(x * 3.1415 * 2.0);\n}\n\n#if 1\n\nfloat Instrument( const in vec2 vFreqTime )\n{\n    float f = vFreqTime.x;\n    float t = vFreqTime.y;\n    \n    if( t < 0.0 )\n        return 0.0;\n    float x = 0.0;\n    float a = 1.0;\n    float h = 1.0;\n    for(int i=0; i<8; i++)\n    {\n        x += Sin( f * t * h ) * exp2( t * -a );\n        x += Sin( f * (t+0.005) * h * 0.5 ) * exp2( t * -a * 2.0 ) ;\n        h = h + 1.01;\n        a = a * 2.0;\n    }\n    \n    return x;\n}\n\n#else\n\nfloat Function(float t, float f)\n{\n    float t2 = t * f * radians(180.0);\n    float y = 0.0;\n    \n    float h = 1.0;\n    float a = 1.0;\n    for( int i=0; i<8; i++)\n    {\n        float inharmonicity = 0.001;\n        float f2 = h * sqrt( 1.0 + h * h *  inharmonicity);\n        float r = sin( t2 * f2 );\n\n        //r = r * a;\n        r = r * exp2(t * -2.0 / a);\n        \n        y += r;\n\n        h = h + 1.0;\n        a = a * 0.6;\n    }\n    \n    //y *= exp2(t * -4.0);\n    return y;\n}\n\nfloat Main( float t, float f )\n{\n    return Function(t, f) + Function(t + 0.01, f * 0.51);\n}\n\nfloat Instrument( const in vec2 vFreqTime )\n{\n    return Main(vFreqTime.y, vFreqTime.x);\n}\n#endif\n\nconst float kMidiTimebase = 240.0;\nconst float kInvMidiTimebase = 1.0 / kMidiTimebase;\nconst float kTranspose = 12.0 * 0.0;\n\nvec2 GetNoteData( const in vec2 vMidiResult, const in float fMidiTime )\n{\n    return vec2( NoteToHz(vMidiResult.x + kTranspose), abs(fMidiTime - vMidiResult.y) * kInvMidiTimebase );\n}\n\nfloat PlayMidi( const in float time )\n{\n    if(time < 0.0)\n\t\treturn 0.0;\n    \n    float fMidiTime = time * kMidiTimebase;\n    \n    float fResult = 0.0;\n    \n    fResult += Instrument( GetNoteData( GetTrack0ANote(fMidiTime), fMidiTime ) );\n    fResult += Instrument( GetNoteData( GetTrack0BNote(fMidiTime), fMidiTime ) );\n    fResult += Instrument( GetNoteData( GetTrack0CNote(fMidiTime), fMidiTime ) );\n    fResult += Instrument( GetNoteData( GetTrack0DNote(fMidiTime), fMidiTime ) );\n    fResult += Instrument( GetNoteData( GetTrack0ENote(fMidiTime), fMidiTime ) );\n    fResult += Instrument( GetNoteData( GetTrack0FNote(fMidiTime), fMidiTime ) );\n    \n    fResult = clamp(fResult * 0.05, -1.0, 1.0);\n    \n    float fFadeEnd = 60.0;\n    float fFadeTime = 5.0;\n    float fFade = (time - (fFadeEnd - fFadeTime)) / fFadeTime;    \n    fResult *= clamp(1.0 - fFade, 0.0, 1.0);\n    \n    return fResult;\n}\n\nvec2 mainSound(float time)\n{\n    return vec2( PlayMidi(time) );\n}\n\n//#define IMAGE_SHADER\n\n#ifdef IMAGE_SHADER\n\nfloat Function( float x )\n{\n\treturn mainSound( iGlobalTime + x / (44100.0 / 60.0) ).x * 0.5 + 0.5;\n}\n\nfloat Plot( vec2 uv )\n{\n\tfloat y = Function(uv.x);\n\t\n\treturn abs(y - uv.y) * iResolution.y;\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\t\n\tvec3 vResult = vec3(0.0);\n\t\n\tvResult += Plot(uv);\n\t\n\tfragColor = vec4((vResult),1.0);\n}\n#endif\n",
				"name": "",
				"description": "",
				"type": "sound"
			}
		]
	}
}