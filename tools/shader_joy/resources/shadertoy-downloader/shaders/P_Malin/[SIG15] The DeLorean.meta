{
	"Shader": {
		"ver": "0.1",
		"info": {
			"id": "MlsSzf",
			"date": "1439221890",
			"viewed": 2332,
			"name": "[SIG15] The DeLorean",
			"username": "P_Malin",
			"description": "Ironically running out of time to do everything I wanted - I should have started this a lot sooner. <br/>Thanks to my wife for her infinite patience.",
			"likes": 38,
			"published": 3,
			"flags": 8,
			"tags": [
				"sig15",
				"delorean"
			],
			"hasliked": 0
		},
		"renderpass": [
			{
				"inputs": [
					{
						"id": 4,
						"src": "/presets/tex03.jpg",
						"ctype": "texture",
						"channel": 0
					},
					{
						"id": 27,
						"src": "/presets/cube05_0.png",
						"ctype": "cubemap",
						"channel": 1
					},
					{
						"id": 30,
						"src": "/presets/tex16.png",
						"ctype": "texture",
						"channel": 2
					}
				],
				"outputs": [
					{
						"channel": "0",
						"dst": "-1"
					},
					{
						"channel": "0",
						"dst": "-1"
					},
					{
						"channel": "0",
						"dst": "-1"
					}
				],
				"code": "",
				"name": "",
				"description": "",
				"type": "image"
			},
			{
				"inputs": [],
				"outputs": [],
				"code": "//#define DISABLE_SOUND \n\n#define N(T,N) t+=float(T); if(x>t) r=vec2(N,t);\n#define L(T,N,X) t+=float(T); if((x>t) && (x<(t+float(X)))) r=vec2(N,t);\n\n/* Start of main()\nHeader.id='MThd'\nHeader.size=6\nReading MThd Chunk\nType: 1, trackCount: 8, timeBase: 96\nHeader.id='MTrk'\nHeader.size=99\nReading MTrk Chunk\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=4158\nReading MTrk Chunk\nTrack Name:'Trumpet'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=4318\nReading MTrk Chunk\nTrack Name:'Trombone'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=10524\nReading MTrk Chunk\nTrack Name:'Treble Strings'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=13845\nReading MTrk Chunk\nTrack Name:'Contrabass'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=2291\nReading MTrk Chunk\nTrack Name:'Timpani'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=2303\nReading MTrk Chunk\nTrack Name:'Tuba'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\nHeader.id='MTrk'\nHeader.size=2280\nReading MTrk Chunk\nTrack Name:'Pizzicato strings'\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nTempo\nTime signature\nTime signature\nTime signature\nTime signature\nEnd of track\n*/\nvec2 GetTrack0Note(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    return r;\n}\n\nvec2 GetTrack1ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(0,67) N(48,72) N(48,67) N(48,74) N(48,79) N(48,72) N(192,65) N(192,71) N(336,72) N(24,74) N(24,72)\n    N(64,69) N(64,65) N(64,71) N(144,72) N(24,74) N(24,72) N(96,67) N(96,72) N(96,79) N(96,79) N(192,78)\n    N(144,76) N(24,78) N(24,79) N(768,74) N(128,76) N(32,74) N(32,72) N(64,74) N(64,72) N(64,74) N(288,79)\n    N(96,77) N(128,76) N(32,74) N(32,76) N(64,74) N(64,72) N(64,74) N(192,62) N(64,69) N(64,71) N(64,72)\n    N(128,76) N(64,79) N(128,81) N(64,82) N(64,74) N(64,77) N(64,77) N(64,72) N(64,77) N(64,74) N(128,72)\n    N(32,70) N(32,70) N(576,72) N(128,70) N(32,68) N(32,68) N(576,58) N(128,56) N(32,54) N(32,54) N(192,70)\n    return r;\n}\n\nvec2 GetTrack1BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(2928,77) N(192,76) N(1920,81) N(192,77) N(128,75) N(32,74) N(32,74) N(576,75) N(128,73) N(32,72)\n    N(32,72) N(576,61) N(128,59) N(32,58) N(32,58) N(192,73)\n    return r;\n}\n\nvec2 GetTrack2ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(0,55) N(48,60) N(48,55) N(48,62) N(48,67) N(48,60) N(192,57) N(192,59) N(384,60) N(64,57) N(64,53)\n    N(64,55) N(192,60) N(96,55) N(96,57) N(96,57) N(96,69) N(192,62) N(192,62) N(768,62) N(192,60) N(192,67)\n    N(128,67) N(32,67) N(32,67) N(192,58) N(192,55) N(192,62) N(128,62) N(32,62) N(32,62) N(64,69) N(64,71)\n    N(64,72) N(128,71) N(32,69) N(32,71) N(64,67) N(64,74) N(64,74) N(64,74) N(64,72) N(32,70) N(32,72)\n    N(64,72) N(64,77) N(64,74) N(128,72) N(32,70) N(32,70) N(576,72) N(128,70) N(32,68) N(32,68) N(576,61)\n    N(128,59) N(32,58) N(32,58) N(192,70)\n    return r;\n}\n\nvec2 GetTrack2BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,65) N(192,53) N(192,62) N(384,65) N(64,65) N(64,65) N(64,59) N(192,64) N(96,60) N(96,64) N(96,64)\n    N(96,72) N(192,69) N(192,67) N(768,69) N(192,67) N(192,72) N(128,72) N(32,72) N(32,71) N(192,70) N(192,67)\n    return r;\n}\n\nvec2 GetTrack2CNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,69) N(192,60) N(192,67) N(384,69) N(64,69) N(128,62) N(192,67) N(96,64) N(96,69) N(96,72) N(288,74)\n    N(192,71) N(1536,74)\n    return r;\n}\n\nvec2 GetTrack2DNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(1200,67) N(288,67) N(192,76)\n    return r;\n}\n\nvec2 GetTrack3ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(0,79) N(48,84) N(48,79) N(48,86) N(48,91) N(48,77) N(192,65) N(192,71) N(336,84) N(24,86) N(24,84)\n    N(64,81) N(64,77) N(64,83) N(144,84) N(24,86) N(24,76) N(96,72) N(96,67) N(96,76) N(96,72) N(192,69)\n    N(144,76) N(24,78) N(24,67) N(768,69) N(128,76) N(32,74) N(32,67) N(64,67) N(64,67) N(64,60) N(192,59)\n    N(192,74) N(128,76) N(32,74) N(32,64) N(64,62) N(64,60) N(64,62) N(192,74) N(192,72) N(192,71) N(192,82)\n    N(192,81) N(192,62) N(384,68) N(384,60) N(384,66) N(384,58) N(384,73)\n    return r;\n}\n\nvec2 GetTrack3BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,81) N(192,72) N(192,79) N(768,79) N(96,76) N(96,72) N(96,81) N(96,69) N(192,74) N(144,88) N(24,90)\n    N(24,86) N(768,77) N(192,76) N(64,74) N(64,72) N(64,72) N(192,67) N(192,70) N(192,67) N(64,67) N(64,72)\n    N(64,66) N(192,62) N(384,67) N(192,74) N(192,72) N(192,77) N(384,74) N(384,75) N(384,72) N(384,73)\n    return r;\n}\n\nvec2 GetTrack3CNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,84) N(192,77) N(192,83) N(768,84) N(96,79) N(96,84) N(96,91) N(96,81) N(192,81) N(192,91) N(768,74)\n    N(192,72) N(192,74) N(192,71) N(192,77) N(192,76) N(64,74)\n    return r;\n}\n\nvec2 GetTrack3DNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(1776,91) N(192,90)\n    return r;\n}\n\nvec2 GetTrack4ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(0,43) N(48,48) N(48,43) N(48,50) N(48,57) L(48,53,12) L(24,41,12) L(24,53,12) L(24,41,12) L(24,53,12)\n    L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12)\n    L(24,53,12) L(24,53,12) L(24,41,12) L(24,53,12) L(24,41,12) L(24,53,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    N(24,48) N(192,55) N(96,50) N(192,40) N(192,45) N(192,45) N(144,54) N(96,57) L(48,43,12) L(24,31,12)\n    L(24,43,12) L(24,31,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,31,12) L(24,43,12) L(24,31,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) N(24,57) N(192,55) L(192,43,12) L(24,55,12) L(24,43,12) L(24,55,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,55,12) L(24,43,12) L(24,55,12) L(24,43,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) N(24,54) N(192,57) N(192,41) N(192,40) N(192,39) N(192,38) N(384,32) L(192,44,12) L(24,32,12)\n    L(24,44,12) L(24,32,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12)\n    L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) N(216,42) L(192,30,12) L(24,42,12) L(24,30,12)\n    L(24,42,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12)\n    L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) N(216,28) L(192,40,12) L(24,28,12) L(24,40,12)\n    return r;\n}\n\nvec2 GetTrack4BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    L(240,41,12) L(24,53,12) L(24,41,12) L(24,53,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,53,12) L(24,41,12)\n    L(24,53,12) L(24,41,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12)\n    L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) N(24,41) N(192,41) N(96,41) N(576,38)\n    N(144,38) N(96,38) L(48,31,12) L(24,43,12) L(24,31,12) L(24,43,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,43,12) L(24,31,12) L(24,43,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) N(24,38) N(192,40)\n    L(192,55,12) L(24,43,12) L(24,55,12) L(24,43,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,43,12) L(24,55,12)\n    L(24,43,12) L(24,55,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) N(24,50) N(192,52) N(192,53) N(192,52)\n    N(192,51) N(192,50) N(384,44) L(192,32,12) L(24,44,12) L(24,32,12) L(24,44,12) L(24,32,12) L(24,32,12)\n    L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12)\n    L(24,32,12) N(216,30) L(192,42,12) L(24,30,12) L(24,42,12) L(24,30,12) L(24,42,12) L(24,42,12) L(24,42,12)\n    L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12)\n    N(216,40) L(192,28,12) L(24,40,12) L(24,28,12)\n    return r;\n}\n\nvec2 GetTrack4CNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    L(252,41,12) L(24,41,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12)\n    L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12)\n    L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) N(204,50) L(972,31,12) L(24,31,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,31,12) L(24,31,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) N(24,43) N(204,52) L(204,55,12) L(24,55,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) N(24,55) L(1560,32,12)\n    L(24,32,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12)\n    L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) L(24,44,12) N(24,44) L(408,42,12) L(24,42,12) L(24,30,12)\n    L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12) L(24,30,12)\n    L(24,30,12) L(24,30,12) L(24,30,12) N(24,30) L(408,28,12) L(24,28,12)\n    return r;\n}\n\nvec2 GetTrack4DNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    L(252,53,12) L(24,53,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12) L(24,41,12)\n    L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12)\n    L(24,53,12) L(24,53,12) L(24,53,12) L(24,53,12) N(24,53) L(1176,43,12) L(24,43,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,31,12) L(24,31,12) L(24,43,12) L(24,43,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12) L(24,31,12)\n    N(24,31) L(408,43,12) L(24,43,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12) L(24,55,12)\n    L(24,55,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12)\n    L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) L(24,43,12) N(24,43) L(1560,44,12) L(24,44,12) L(24,32,12)\n    L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12) L(24,32,12)\n    L(24,32,12) L(24,32,12) L(24,32,12) N(24,32) L(408,30,12) L(24,30,12) L(24,42,12) L(24,42,12) L(24,42,12)\n    L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12) L(24,42,12)\n    L(24,42,12) N(24,42) L(408,40,12) L(24,40,12)\n    return r;\n}\n\nvec2 GetTrack4ENote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(2928,50)\n    return r;\n}\n\nvec2 GetTrack5ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(1008,36) N(288,41) N(192,40) N(192,45) N(192,38) N(144,38) N(96,38) N(48,43) N(24,43) N(24,43) N(24,43)\n    N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43) N(24,43)\n    N(24,43) N(24,43) N(96,43) N(96,43) N(96,43) N(96,50) N(192,52) N(192,55) N(384,46) N(192,48) N(192,38)\n    return r;\n}\n\nvec2 GetTrack5BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(1008,41) N(288,50) N(876,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38)\n    N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(24,38) N(396,38) N(192,40) N(192,43) N(768,50)\n    return r;\n}\n\nvec2 GetTrack6ANote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,53) N(384,59) N(384,48) N(288,50) N(192,40) N(192,45) N(192,50) N(144,50) N(96,50) N(48,55)\n    N(768,38) N(192,40) N(192,55) N(384,34) N(192,36) N(192,50) N(192,40) N(192,41) N(192,40) N(192,39)\n    N(192,38) N(384,32) N(768,30) N(768,28)\n    return r;\n}\n\nvec2 GetTrack6BNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(240,41) N(384,41) N(384,41) N(288,41) N(576,38) N(144,38) N(96,38) N(48,43) N(1152,43) N(384,53)\n    N(192,48) N(192,38) N(192,52) N(192,53) N(192,52) N(192,51) N(192,50) N(384,44) N(768,42) N(768,40)\n    return r;\n}\n\nvec2 GetTrack6CNote(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    N(3696,46)\n    return r;\n}\n\nvec2 GetTrack7Note(float x)\n{\n    vec2 r = vec2(-1.0);\n    float t = 0.0;\n    return r;\n}\n\n\n// ------------------- 8< ------------------- 8< ------------------- 8< -------------------\n\n\n#define PI radians(180.0)\n#define TWO_PI radians(360.0)\n\nfloat NoteToHz(float n)\n{  \t\n\treturn 440.0*pow( 2.0, (n-69.0)/12.0 );\n}\n\nfloat Tri( float t )\n{\n\treturn abs(fract( t ) * 4.0 - 2.0) - 1.0;\n}\n\nfloat Saw( float t )\n{\n\treturn fract( t ) * 2.0 - 1.0;\n}\n\nvec4 Saw4( vec4 x )\n{\n\treturn fract( x ) * 2.0 - 1.0;\n}\n\nfloat Sin( float t )\n{\n\treturn sin( t * radians(360.0) );\n}\n\nfloat Cos( float t )\n{\n\treturn cos( t * radians(360.0) );\n}\n\nvec4 Cos4( vec4 x )\n{\n\tx = abs(fract(x) * 2.0 - 1.0);\n\tvec4 x2 = x*x;\n\treturn x2 * 6.0 - x2*x * 4.0  - 1.0;\n}\n\nfloat Square( float t )\n{\n\treturn step( fract(t), 0.5 ) * 2.0 - 1.0;\n}\n\n// Thanks to Dave_Hoskins for the hash\nfloat Hash(float p)\n{\n\tvec2 p2 = fract(vec2(p * 5.3983, p * 5.4427));\n    p2 += dot(p2.yx, p2.xy + vec2(21.5351, 14.3137));\n\treturn fract(p2.x * p2.y * 95.4337);\n}\n\nfloat Noise( float x )\n{\n\treturn Hash( floor(x * 32.0) ) * 2.0 - 1.0;\n}\n\nfloat SmoothNoise( float t )\n{\n\tfloat noiset = t * 32.0;\n\tfloat tfloor = floor(noiset);\n\tfloat ffract = fract(noiset);\n\t\n\tfloat n0 = Hash(tfloor);\n\tfloat n1 = Hash(tfloor + 1.0);\n\tfloat blend = ffract*ffract*(3.0 - 2.0*ffract);\n\treturn mix(n0, n1, blend) * 2.0 - 1.0;\n}\n\nfloat FBM( float t, float persistence )\n{\n    float result = 0.0;\n    \n    float a = 1.0;\n    float tot = 0.0;\n    result += SmoothNoise(t) * a; tot += a; t *= 2.02; a *= persistence;\n    result += SmoothNoise(t) * a; tot += a; t *= 2.02; a *= persistence; \n    result += SmoothNoise(t) * a; tot += a; t *= 2.02; a *= persistence; \n    result += SmoothNoise(t) * a; tot += a; t *= 2.02; a *= persistence; \n    tot += a; \n    return result / tot;\n}\n\n\nfloat StepNoise( float t, float freq )\n{\n\tfloat noiset = t * freq;\n\tfloat tfloor = floor(noiset);\n\t\n\tfloat n = Hash(tfloor);\n\treturn n * 2.0 - 1.0;\n}\n\nfloat Cos4(float x, vec4 phase, vec4 freq, vec4 amp)\n{\n\treturn dot(Cos4((x+phase) * freq), amp);\n}\n\nfloat Saw4(float x, vec4 phase, vec4 freq, vec4 amp)\n{\n\treturn dot(Saw4((x+phase) * freq), amp);\n}\n\n\nfloat Test( float t )\n{\n\treturn Saw4(t, vec4(0.0, 0.5, 0.1, 0.4), vec4(1.0, 1.50, 2.00, -3.00), vec4(1.0, 0.5, 0.25, 0.125));\n}\n\nfloat Envelope( float time, float decay )\n{\t\n\treturn exp2( -time * (5.0 / decay) );\n}\n\nfloat Envelope( float time, float attack, float decay )\n{\n\tif( time < attack )\n\t{\n\t\treturn time/attack;\n\t}\n\n\ttime -= attack;\n\n\treturn Envelope( time, decay );\n}\n\nfloat Test2(float f)\n{\n    return Test(f) + Test(f - 0.0454) * 0.4 + Test(f - 0.1123) * 0.3 + Test(f - 0.1523) * 0.1;\n}\n\nfloat Instrument( const in vec2 vFreqTime )\n{\n    float f = vFreqTime.x;\n    float t = vFreqTime.y;\n    \n    if( t < 0.0 )\n        return 0.0;\n    float x = 0.0;\n    float a = 0.5;\n    float h = 1.0;\n    float p = 0.0;\n    for(int i=0; i<8; i++)\n    {\n        x += Sin( f * t * h + p ) * exp2( t * -a );\n        x += Sin( f * (t+0.005) * h * 0.5 + p ) * exp2( t * -a * 2.0 ) ;\n        //x += Sin( f * t * h + p ) * exp2( t * -a );\n        //x += Sin( f * (t+0.005) * h * 0.5 + p ) * exp2( t * -a * 2.0 ) ;\n        h = h + 1.01;\n        a = a * 2.0;\n        p += 0.1;\n    }\n    \n    return x;\n}\n\nfloat Instr( const in vec2 vFreqTime )\n{\n    float f = vFreqTime.x;\n    float t = vFreqTime.y;\n    \n    float d = f * t + Sin(f * t * 0.5) * exp2(t * -5.0) * 2.0;\n    float x = Sin(d);\n    \n    return x * exp2(t * -1.0) * 2.0;\n}\n\n\nfloat Track1Instrument( const in vec2 vFreqTime )\n{\n    return Instr( vFreqTime );\n}\n\nfloat Track2Instrument( const in vec2 vFreqTime )\n{\n    return Instrument( vFreqTime ) * 0.5;\n}\n\nfloat Track3Instrument( const in vec2 vFreqTime )\n{\n    return 2.0 * (Tri(vFreqTime.x * vFreqTime.y) + Saw(vFreqTime.x * vFreqTime.y * 0.5 + 0.01) * 0.5) * Envelope(vFreqTime.y, 4.0);\n}\n\nfloat Track4Instrument( const in vec2 vFreqTime )\n{\n     return Instrument( vFreqTime ) * 0.2;\n}\n\n\nconst float kMidiTimebase = 240.0;\nconst float kInvMidiTimebase = 1.0 / kMidiTimebase;\n\nvec2 GetNoteData( const in vec2 vMidiResult, const in float fMidiTime )\n{\n    return vec2( NoteToHz(vMidiResult.x), abs(fMidiTime - vMidiResult.y) * kInvMidiTimebase );\n}\n\nfloat PlayMidi( const in float time )\n{\n#ifdef DISABLE_SOUND\n\treturn 0.0;\n#else\n    if(time < 0.0)\n\t\treturn 0.0;\n    \n    float fMidiTime = time * kMidiTimebase;\n    \n    float fResult = 0.0;\n    \n    fResult += Track1Instrument( GetNoteData( GetTrack1ANote(fMidiTime), fMidiTime ) );\n    fResult += Track1Instrument( GetNoteData( GetTrack1BNote(fMidiTime), fMidiTime ) );\n    //fResult += Track1Instrument( GetNoteData( GetTrack1CNote(fMidiTime), fMidiTime ) );\n\n    fResult += Track2Instrument( GetNoteData( GetTrack2ANote(fMidiTime), fMidiTime ) );\n    fResult += Track2Instrument( GetNoteData( GetTrack2BNote(fMidiTime), fMidiTime ) );\n    fResult += Track2Instrument( GetNoteData( GetTrack2CNote(fMidiTime), fMidiTime ) );\n    fResult += Track2Instrument( GetNoteData( GetTrack2DNote(fMidiTime), fMidiTime ) );\n\n    fResult += Track3Instrument( GetNoteData( GetTrack3ANote(fMidiTime), fMidiTime ) );\n    fResult += Track3Instrument( GetNoteData( GetTrack3BNote(fMidiTime), fMidiTime ) );\n    fResult += Track3Instrument( GetNoteData( GetTrack3CNote(fMidiTime), fMidiTime ) );\n    fResult += Track3Instrument( GetNoteData( GetTrack3DNote(fMidiTime), fMidiTime ) );\n\n    fResult += Track4Instrument( GetNoteData( GetTrack4ANote(fMidiTime), fMidiTime ) );\n    fResult += Track4Instrument( GetNoteData( GetTrack4BNote(fMidiTime), fMidiTime ) );\n    fResult += Track4Instrument( GetNoteData( GetTrack4CNote(fMidiTime), fMidiTime ) );\n    fResult += Track4Instrument( GetNoteData( GetTrack4DNote(fMidiTime), fMidiTime ) );\n\n    fResult += Track2Instrument( GetNoteData( GetTrack5ANote(fMidiTime), fMidiTime ) );\n    fResult += Track2Instrument( GetNoteData( GetTrack5BNote(fMidiTime), fMidiTime ) );\n    //fResult += Track2Instrument( GetNoteData( GetTrack5CNote(fMidiTime), fMidiTime ) );\n    //fResult += Track2Instrument( GetNoteData( GetTrack5DNote(fMidiTime), fMidiTime ) );\n\n    fResult += Track4Instrument( GetNoteData( GetTrack6ANote(fMidiTime), fMidiTime ) );\n    fResult += Track4Instrument( GetNoteData( GetTrack6BNote(fMidiTime), fMidiTime ) );\n    \n    fResult = clamp(fResult * 0.05, -1.0, 1.0);\n    /*\n    float fFadeEnd = 20.0 * 240.0 / kMidiTimebase;\n    float fFadeTime = 5.0;\n    float fFade = (time - (fFadeEnd - fFadeTime)) / fFadeTime;    \n    fResult *= clamp(1.0 - fFade, 0.0, 1.0);\n    */\n    return fResult;\n#endif\n}\n\nvec2 mainSound(float time)\n{\n    return vec2( PlayMidi(time ) );\n}\n\n//#define IMAGE_SHADER\n\n#ifdef IMAGE_SHADER\n\nfloat Function( float x )\n{\n\treturn mainSound( iGlobalTime + x / (44100.0 / 60.0) ).x * 0.5 + 0.5;\n}\n\nfloat Plot( vec2 uv )\n{\n\tfloat y = Function(uv.x);\n\t\n\treturn abs(y - uv.y) * iResolution.y;\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\t\n\tvec3 vResult = vec3(0.0);\n\t\n\tvResult += Plot(uv);\n\t\n\tfragColor = vec4((vResult),1.0);\n}\n#endif\n",
				"name": "",
				"description": "",
				"type": "sound"
			}
		]
	}
}